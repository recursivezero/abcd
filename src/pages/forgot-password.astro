---
import "@/assets/styles/signup.css";
import logoImage from "/public/assets/images/512x512.png";
import { Picture } from "astro:assets";
import SunIcon from "@/assets/icons/sun.svg";
import MoonIcon from "@/assets/icons/moon.svg";
---

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Forgot Password</title>
</head>
<body>
  <div class="signup-container">
    <div class="signup-left">
      <div class="signup-header">
        <div class="logo">
          <Picture src={logoImage} formats={["png", "webp"]} alt="template logo" height = {50} width = {50} class="logo" />
        </div>
        <a href="/" class="back-link">
          Back to website <span class="arrow">→</span>
        </a>
      </div>

      <div class="slider-container" id="slider-wrapper">
        <div class="slider">
          <div class="slide active">
            <img alt="Image 1" />
            <div class="slide-caption">
              <h2>Capturing Moments,<br />Creating Memories</h2>
            </div>
          </div>
          <div class="slide">
            <img alt="Image 2" />
            <div class="slide-caption">
              <h2>Share Your Vision,<br />Express Your Style</h2>
            </div>
          </div>
          <div class="slide">
            <img alt="Image 3" />
            <div class="slide-caption">
              <h2>Design Your World,<br />One Click at a Time</h2>
            </div>
          </div>
          <div class="slide">
            <img alt="Image 4" />
            <div class="slide-caption">
              <h2>Capturing Moments,<br />Creating Memories</h2>
            </div>
          </div>
          <div class="slide">
            <img alt="Image 5" />
            <div class="slide-caption">
              <h2>Share Your Vision,<br />Express Your Style</h2>
            </div>
          </div>
          <div class="slide">
            <img alt="Image 6" />
            <div class="slide-caption">
              <h2>Design Your World,<br />One Click at a Time</h2>
            </div>
          </div>
        </div>
        <div class="slider-dots">
          <span class="dot active" data-index="0"></span>
          <span class="dot" data-index="1"></span>
          <span class="dot" data-index="2"></span>
          <span class="dot" data-index="3"></span>
          <span class="dot" data-index="4"></span>
          <span class="dot" data-index="5"></span>
        </div>
      </div>
    </div>

    <div class="signup-right">
      <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme">
        <SunIcon id="theme-icon-sun" width={24} height={24} />
        <MoonIcon id="theme-icon-moon" width={24} height={24} />
      </button>
      <div class="form-container">
        <h1>Forgot Password?</h1>
        <p class="signup-text">No worries, we'll send you reset instructions.</p>

        <form class="signup-form" style="margin-top: 2rem;">
          <div class="input-group">
            <input type="email" id="email" placeholder="Enter your email" required />
          </div>

          <button type="submit" class="create-account-btn">Send Reset Link</button>
        </form>
        <div style="text-align: center; margin-top: 1.5rem;">
          <a href="/login" class="signup-link">← Back to log in</a>
        </div>
      </div>
    </div>
  </div>
</body>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const slideImages = [
      { dark: "/assets/images/screenshots/capital.PNG", light: "/assets/images/screenshots/capitalLight.png" },
      { dark: "/assets/images/screenshots/colors.PNG", light: "/assets/images/screenshots/colorsLight.png" },
      { dark: "/assets/images/screenshots/quote.PNG", light: "/assets/images/screenshots/quoteLight.png" },
      { dark: "/assets/images/screenshots/story.png", light: "/assets/images/screenshots/storyLight.png" },
      { dark: "/assets/images/screenshots/map.png", light: "/assets/images/screenshots/mapLight.png" },
      { dark: "/assets/images/screenshots/varnmala.png", light: "/assets/images/screenshots/varnmalaLight.png" }
    ];
    const imageElements = document.querySelectorAll<HTMLImageElement>(".slide img");
    const sliderWrapper = document.getElementById("slider-wrapper");

    const slides = document.querySelectorAll(".slide");
    const dots = document.querySelectorAll(".dot");
    let currentSlide = 0;
    let slideInterval: number | undefined;

    function startSlider(): void {
      slideInterval = window.setInterval(nextSlide, 5000);
    }

    function showSlide(index: number): void {
      slides.forEach((slide) => slide.classList.remove("active"));
      dots.forEach((dot) => dot.classList.remove("active"));
      currentSlide = (index + slides.length) % slides.length;
      slides[currentSlide].classList.add("active");
      dots[currentSlide].classList.add("active");
    }

    function nextSlide(): void {
      showSlide(currentSlide + 1);
    }

    dots.forEach((dot, index) => {
      dot.addEventListener("click", () => {
        if (slideInterval) clearInterval(slideInterval);
        showSlide(index);
        startSlider();
      });
    });

    showSlide(0);
    startSlider();

    const forgotPasswordForm = document.querySelector(".signup-form");
    if (forgotPasswordForm) {
      forgotPasswordForm.addEventListener("submit", function (event) {
        event.preventDefault();
        alert("Please check your mail, we've sent a password reset link.");
      });
    }

    type Theme = "light" | "dark";
    const themeToggleButton = document.getElementById("theme-toggle");

    const updateSliderImages = (theme: Theme) => {
      imageElements.forEach((imgElement, index) => {
        if (slideImages[index]) {
          imgElement.src = slideImages[index][theme];
        }
      });
    };

    const applyTheme = (theme: Theme) => {
      document.documentElement.setAttribute("data-theme", theme);
      localStorage.setItem("theme", theme);
      updateSliderImages(theme);
      if (sliderWrapper) sliderWrapper.style.opacity = '1';
    };

    const savedTheme = localStorage.getItem("theme") as Theme | null;
    const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
    if (savedTheme) {
      applyTheme(savedTheme);
    } else if (prefersDark) {
      applyTheme("dark");
    } else {
      applyTheme("light");
    }

    themeToggleButton?.addEventListener("click", () => {
      const currentTheme = document.documentElement.getAttribute("data-theme") as Theme;
      const newTheme = currentTheme === "dark" ? "light" : "dark";
      applyTheme(newTheme);
    });
  });
</script>
