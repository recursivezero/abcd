---
import BaseLayout from "@/layouts/Base";
import "@/assets/styles/barahkhadi/index.css";

const consonants = [
  ["‡§ï", "‡§ñ", "‡§ó", "‡§ò", "‡§ô"],
  ["‡§ö", "‡§õ", "‡§ú", "‡§ù", "‡§û"],
  ["‡§ü", "‡§†", "‡§°", "‡§¢", "‡§£"],
  ["‡§§", "‡§•", "‡§¶", "‡§ß", "‡§®"],
  ["‡§™", "‡§´", "‡§¨", "‡§≠", "‡§Æ"],
  ["‡§Ø", "‡§∞", "‡§≤", "‡§µ"],
  ["‡§∂", "‡§∑", "‡§∏", "‡§π"]
];

const matras = ["", "‡§æ", "‡§ø", "‡•Ä", "‡•Å", "‡•Ç", "‡•á", "‡•à", "‡•ã", "‡•å", "‡§Ç", "‡§É"];
---

<script>
  document.querySelectorAll(".quick-view-btn").forEach((button) => {
    button.addEventListener("click", (e) => {
      // Close all other open popovers
      document.querySelectorAll('.consonant-card[data-active="true"]').forEach((card) => {
        if (card !== (e.currentTarget as HTMLElement).closest(".consonant-card")) {
          // Don't reset current card
          const btn = card.querySelector(".quick-view-btn") as HTMLElement;
          card.setAttribute("data-active", "false");
          btn.textContent = "üîç";
        }
      });

      // Toggle current popover
      const card = (e.currentTarget as HTMLElement).closest(".consonant-card") as HTMLElement;
      const isActive = card.getAttribute("data-active") === "true";
      const newState = !isActive;
      card.setAttribute("data-active", String(newState));
      (e.currentTarget as HTMLElement).textContent = newState ? "‚úñÔ∏è" : "üîç";
    });
  });
</script>

<BaseLayout meta={{ title: "Barahkhadi" }}>
  <div class="container__barahkhadi">
    <div class="consonants-rows">
      {
        consonants.map((row) => (
          <div class="consonant-row">
            <div class="consonants-grid">
              {row.map((consonant) => (
                <div class="consonant-card" data-active="false">
                  <a href={`/barahkhadi/${consonant}`} class="consonant-content">
                    <span class="consonant">{consonant}</span>
                  </a>
                  <button class="quick-view-btn">üîç</button>
                  <div class="barahkhadi-popover">
                    <div class="variations-grid">
                      {matras.map((matra) => (
                        <div class="variation">{consonant + matra}</div>
                      ))}
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        ))
      }
    </div>
  </div>
</BaseLayout>
